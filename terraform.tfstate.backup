{
    "version": 3,
    "terraform_version": "0.9.2",
    "serial": 8,
    "lineage": "9c4bdb97-9f63-4b17-acbd-d84dc9f1fb86",
    "modules": [
        {
            "path": [
                "root"
            ],
            "outputs": {
                "backends": {
                    "sensitive": false,
                    "type": "string",
                    "value": "http://217.182.88.181:5000\nhttp://217.182.89.84:5000"
                },
                "frontend": {
                    "sensitive": false,
                    "type": "string",
                    "value": "http://217.182.89.106"
                }
            },
            "resources": {
                "data.template_file.frontend_user_data": {
                    "type": "template_file",
                    "depends_on": [
                        "openstack_compute_instance_v2.backends.*",
                        "openstack_compute_instance_v2.backends.*"
                    ],
                    "primary": {
                        "id": "8a0d590f7aa43f4018aa677b7f4e352c303c7219064ded0c8b4b354e220d1b58",
                        "attributes": {
                            "id": "8a0d590f7aa43f4018aa677b7f4e352c303c7219064ded0c8b4b354e220d1b58",
                            "rendered": "#!/bin/bash\n\napt-get update\napt-get -y install git haproxy vim\n\ncat \u003c\u003cEOF \u003e /etc/haproxy/haproxy.cfg\nglobal\n    log /dev/log    local0\n    log /dev/log    local1 notice\n    chroot /var/lib/haproxy\n    stats socket /run/haproxy/admin.sock mode 660 level admin\n    stats timeout 30s\n    user haproxy\n    group haproxy\n    daemon\n\n    # Default SSL material locations\n    ca-base /etc/ssl/certs\n    crt-base /etc/ssl/private\n\n    # Default ciphers to use on SSL-enabled listening sockets.\n    # For more information, see ciphers(1SSL). This list is from:\n    #  https://hynek.me/articles/hardening-your-web-servers-ssl-ciphers/\n    ssl-default-bind-ciphers ECDH+AESGCM:DH+AESGCM:ECDH+AES256:DH+AES256:ECDH+AES128:DH+AES:ECDH+3DES:DH+3DES:RSA+AESGCM:RSA+AES:RSA+3DES:!aNULL:!MD5:!DSS\n    ssl-default-bind-options no-sslv3\n\ndefaults\n    log     global\n    mode    http\n    option  httplog\n    option  dontlognull\n    timeout connect 5000\n    timeout client  50000\n    timeout server  50000\n    errorfile 400 /etc/haproxy/errors/400.http\n    errorfile 403 /etc/haproxy/errors/403.http\n    errorfile 408 /etc/haproxy/errors/408.http\n    errorfile 500 /etc/haproxy/errors/500.http\n    errorfile 502 /etc/haproxy/errors/502.http\n    errorfile 503 /etc/haproxy/errors/503.http\n    errorfile 504 /etc/haproxy/errors/504.http\n\nlisten http-in\n    bind *:80\n    server backend-01 217.182.88.181:5000\n    server backend-02 217.182.89.84:5000\n\nEOF\n\nservice haproxy restart\n",
                            "template": "#!/bin/bash\n\napt-get update\napt-get -y install git haproxy vim\n\ncat \u003c\u003cEOF \u003e /etc/haproxy/haproxy.cfg\nglobal\n    log /dev/log    local0\n    log /dev/log    local1 notice\n    chroot /var/lib/haproxy\n    stats socket /run/haproxy/admin.sock mode 660 level admin\n    stats timeout 30s\n    user haproxy\n    group haproxy\n    daemon\n\n    # Default SSL material locations\n    ca-base /etc/ssl/certs\n    crt-base /etc/ssl/private\n\n    # Default ciphers to use on SSL-enabled listening sockets.\n    # For more information, see ciphers(1SSL). This list is from:\n    #  https://hynek.me/articles/hardening-your-web-servers-ssl-ciphers/\n    ssl-default-bind-ciphers ECDH+AESGCM:DH+AESGCM:ECDH+AES256:DH+AES256:ECDH+AES128:DH+AES:ECDH+3DES:DH+3DES:RSA+AESGCM:RSA+AES:RSA+3DES:!aNULL:!MD5:!DSS\n    ssl-default-bind-options no-sslv3\n\ndefaults\n    log     global\n    mode    http\n    option  httplog\n    option  dontlognull\n    timeout connect 5000\n    timeout client  50000\n    timeout server  50000\n    errorfile 400 /etc/haproxy/errors/400.http\n    errorfile 403 /etc/haproxy/errors/403.http\n    errorfile 408 /etc/haproxy/errors/408.http\n    errorfile 500 /etc/haproxy/errors/500.http\n    errorfile 502 /etc/haproxy/errors/502.http\n    errorfile 503 /etc/haproxy/errors/503.http\n    errorfile 504 /etc/haproxy/errors/504.http\n\nlisten http-in\n    bind *:80\n${nodes}\n\nEOF\n\nservice haproxy restart\n",
                            "vars.%": "1",
                            "vars.nodes": "    server backend-01 217.182.88.181:5000\n    server backend-02 217.182.89.84:5000"
                        },
                        "meta": {},
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                },
                "openstack_compute_instance_v2.backends.0": {
                    "type": "openstack_compute_instance_v2",
                    "depends_on": [],
                    "primary": {
                        "id": "db87eb9a-e245-49b8-ba7b-80179529d1f3",
                        "attributes": {
                            "access_ip_v4": "217.182.88.181",
                            "access_ip_v6": "[2001:41d0:401:2100::8eef]",
                            "all_metadata.%": "0",
                            "availability_zone": "nova",
                            "flavor_id": "fe66c25e-b8c3-44c1-9cb9-c87dddfed75c",
                            "flavor_name": "c2-7",
                            "force_delete": "false",
                            "id": "db87eb9a-e245-49b8-ba7b-80179529d1f3",
                            "image_id": "8f6a5b6b-68c7-496a-b3c3-09c0f23b9abc",
                            "image_name": "Debian 8",
                            "key_pair": "arnaud-ovh",
                            "name": "backend-01",
                            "network.#": "1",
                            "network.0.access_network": "false",
                            "network.0.fixed_ip_v4": "217.182.88.181",
                            "network.0.fixed_ip_v6": "[2001:41d0:401:2100::8eef]",
                            "network.0.floating_ip": "",
                            "network.0.mac": "fa:16:3e:15:7c:7f",
                            "network.0.name": "Ext-Net",
                            "network.0.port": "",
                            "network.0.uuid": "ae4fffbd-2cc5-4a34-965b-6b3920276ab3",
                            "region": "SBG3",
                            "security_groups.#": "1",
                            "security_groups.3814588639": "default",
                            "stop_before_destroy": "false",
                            "user_data": "c90040598f95458ad8ac4159c70913cd4de15a30",
                            "volume.#": "0"
                        },
                        "meta": {
                            "e2bfb730-ecaa-11e6-8f88-34363bc7c4c0": {
                                "create": 1800000000000,
                                "delete": 1800000000000,
                                "update": 1800000000000
                            }
                        },
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                },
                "openstack_compute_instance_v2.backends.1": {
                    "type": "openstack_compute_instance_v2",
                    "depends_on": [],
                    "primary": {
                        "id": "6e16785b-1fad-4391-bfe5-b9a83dbd3d19",
                        "attributes": {
                            "access_ip_v4": "217.182.89.84",
                            "access_ip_v6": "[2001:41d0:401:2100::9029]",
                            "all_metadata.%": "0",
                            "availability_zone": "nova",
                            "flavor_id": "fe66c25e-b8c3-44c1-9cb9-c87dddfed75c",
                            "flavor_name": "c2-7",
                            "force_delete": "false",
                            "id": "6e16785b-1fad-4391-bfe5-b9a83dbd3d19",
                            "image_id": "8f6a5b6b-68c7-496a-b3c3-09c0f23b9abc",
                            "image_name": "Debian 8",
                            "key_pair": "arnaud-ovh",
                            "name": "backend-02",
                            "network.#": "1",
                            "network.0.access_network": "false",
                            "network.0.fixed_ip_v4": "217.182.89.84",
                            "network.0.fixed_ip_v6": "[2001:41d0:401:2100::9029]",
                            "network.0.floating_ip": "",
                            "network.0.mac": "fa:16:3e:50:1d:b4",
                            "network.0.name": "Ext-Net",
                            "network.0.port": "",
                            "network.0.uuid": "ae4fffbd-2cc5-4a34-965b-6b3920276ab3",
                            "region": "SBG3",
                            "security_groups.#": "1",
                            "security_groups.3814588639": "default",
                            "stop_before_destroy": "false",
                            "user_data": "c90040598f95458ad8ac4159c70913cd4de15a30",
                            "volume.#": "0"
                        },
                        "meta": {
                            "e2bfb730-ecaa-11e6-8f88-34363bc7c4c0": {
                                "create": 1800000000000,
                                "delete": 1800000000000,
                                "update": 1800000000000
                            }
                        },
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                },
                "openstack_compute_instance_v2.frontend": {
                    "type": "openstack_compute_instance_v2",
                    "depends_on": [
                        "data.template_file.frontend_user_data"
                    ],
                    "primary": {
                        "id": "33f3535b-7f57-4f92-8b2c-3bd66b0cc5a4",
                        "attributes": {
                            "access_ip_v4": "217.182.89.106",
                            "access_ip_v6": "[2001:41d0:401:2100::903d]",
                            "all_metadata.%": "0",
                            "availability_zone": "nova",
                            "flavor_id": "fe66c25e-b8c3-44c1-9cb9-c87dddfed75c",
                            "flavor_name": "c2-7",
                            "force_delete": "false",
                            "id": "33f3535b-7f57-4f92-8b2c-3bd66b0cc5a4",
                            "image_id": "8f6a5b6b-68c7-496a-b3c3-09c0f23b9abc",
                            "image_name": "Debian 8",
                            "key_pair": "arnaud-ovh",
                            "name": "frontend",
                            "network.#": "1",
                            "network.0.access_network": "false",
                            "network.0.fixed_ip_v4": "217.182.89.106",
                            "network.0.fixed_ip_v6": "[2001:41d0:401:2100::903d]",
                            "network.0.floating_ip": "",
                            "network.0.mac": "fa:16:3e:66:63:99",
                            "network.0.name": "Ext-Net",
                            "network.0.port": "",
                            "network.0.uuid": "ae4fffbd-2cc5-4a34-965b-6b3920276ab3",
                            "region": "SBG3",
                            "security_groups.#": "1",
                            "security_groups.3814588639": "default",
                            "stop_before_destroy": "false",
                            "user_data": "91a6d8fbb3713e23a10ca772ef25c634d1d49d54",
                            "volume.#": "0"
                        },
                        "meta": {
                            "e2bfb730-ecaa-11e6-8f88-34363bc7c4c0": {
                                "create": 1800000000000,
                                "delete": 1800000000000,
                                "update": 1800000000000
                            }
                        },
                        "tainted": false
                    },
                    "deposed": [],
                    "provider": ""
                }
            },
            "depends_on": []
        }
    ]
}
